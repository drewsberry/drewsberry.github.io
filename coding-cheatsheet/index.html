<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Coding cheatsheet &middot; Drew Silcock
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/bootstrap_button.css">

  <!-- CDNs-->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/media/site/apple-touch-icon.png">
                                 <link rel="shortcut icon" href="/public/media/site/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52653050-1', 'auto');
  ga('send', 'pageview');

</script>

  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Drew Silcock
        </a>
      </h1>
      <p class="lead">Maybe somebody, somewhere will find this useful.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/archive/">Archive</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/download/">Download</a>
          
        
      
        
          
        
      
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/drewsberry/drewsberry.github.io">GitHub project</a>
      <span class="sidebar-nav-item">Currently v1.0.3</span>
    </nav>

    <p>&copy; 2014. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Coding cheatsheet</h1>
  <span class="post-date">15 Jul 2014</span>
  <p>Herein lies my personal coding cheatsheet for all things I find useful and wish not to forget. It features golden nuggets concerning git, vim, python and perl.</p>

<!--more-->

<h2 id="git">Git</h2>

<h3 id="first-commands">First commands</h3>

<p>These are the things you need to do when using <code>git</code> on a new computer:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Change username associated with commits</span>
git config --global user.name <span class="s2">&quot;&lt;USER&gt;&quot;</span>

<span class="c"># Change email associated with commits</span>
git config --global user.email &lt;EMAIL&gt;

<span class="c"># Cache uname and passwd for convenience (only on git &gt;= 1.7.9)</span>
git config --global credential.helper cache

<span class="c"># Push to current branch only by default</span>
git config --global push.default current</code></pre></div>

<h3 id="adding-remote">Adding remote</h3>

<p>Add remote repository:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git remote add origin https://github.com/username/repository.git</code></pre></div>

<p>Then subsequently set local branch to track remote branch:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git branch --set-upstream master origin/&lt;branch&gt;</code></pre></div>

<h2 id="vim">Vim</h2>

<h3 id="vim-functions">Vim functions</h3>

<p>Here’s the syntax for declaring vim script functions:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">functions MyFunction <span class="p">()</span>
    <span class="k">do</span> <span class="k">first</span> thing
    <span class="k">do</span> second thing
<span class="k">endfunction</span></code></pre></div>

<p>And you then call it in Vim with:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">:</span><span class="k">call</span> MyFunction<span class="p">()</span></code></pre></div>

<h3 id="recognise-custom-filetypes">Recognise custom filetypes</h3>

<p>I’ve got <code>moo.vim</code> files in my <code>~/.vim/after/syntax</code> and <code>~/.vim/after/ftplugin</code>, for all <code>moo</code> files with extension <code>.moo</code>. To get Vim to recognise these <code>.moo</code> files and apply the Vim scripts associated therewith, I need to create a file called <code>moo.vim</code> in <code>~/.vim/ftdetect/</code>, which contains the following:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">au</span> <span class="nb">BufRead</span><span class="p">,</span><span class="nb">BufNewFile</span> *.moo <span class="k">set</span> <span class="k">filetype</span><span class="p">=</span>moo</code></pre></div>

<p><em>Note</em>: You may have to wipe your <code>~/.vim/view</code> before Vim recognises old files as this new filetype.</p>

<h3 id="editing-over-scp">Editing over scp</h3>

<p>Vim comes with the ability to edit files remotely over scp. This can be achieved via:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">vim</span> scp:<span class="sr">//</span>user@servername<span class="sr">//</span><span class="nb">path</span><span class="sr">/to/</span><span class="k">file</span></code></pre></div>

<p>However, trying to save gives the error:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">E382: Cannot <span class="nb">write</span><span class="p">,</span> <span class="s1">&#39;buftype&#39;</span> <span class="k">option</span> <span class="k">is</span> <span class="k">set</span></code></pre></div>

<p>In fact, running <code>set buftype?</code> reveals that <code>buftype</code> is set to <code>nofile</code>, meaning the buffer cannot be saved to file. This can be bypassed by using <code>:Nwrite</code> from the <a href="http://www.vim.org/scripts/script.php?script_id=1075">netrw.vim</a> that comes bundled with Vim 7.0:</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">:</span>Nwrite</code></pre></div>

<h2 id="sshfs">sshfs</h2>

<p>To allow other non-root users to access a filesystem mounted over ssh, use:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sshfs -o allow_other user@servername:/path/to/content /path/to/local/mountpoint</code></pre></div>

<h2 id="photoshop">Photoshop</h2>

<p>Whilst I don’t generally like expensive proprietary software, particularly photoshop, given the importance of this small technique to my current project (on which I will write a full post soon), I felt it important to include how to mask parts of photos in Photoshop, ready to be imported into programs like <a href="http://www.agisoft.ru/products/photoscan">PhotoScan</a> (another piece of incredibly expensive proprietary software).</p>

<ol>
  <li>
    <p>Firstly, select the region you want to mask (or keep unmasked, whichever is easier). The <code>w</code> key switches between the Quick Selection and Magic Wand tools, both useful in their own rights.</p>
  </li>
  <li>
    <p>Next, in the “<em>Channels</em>” group, click “<em>New channel</em>” at the bottom of the group box. The image should now turn black.</p>
  </li>
  <li>
    <p>If you want to mask the selection, press <code>&lt;CMD&gt;&lt;SHIFT&gt;I</code> to invert the selection and press <code>&lt;SHIFT&gt;&lt;F5&gt;</code>; select “<em>White</em>” and press <code>&lt;CR&gt;</code>. If you want to mask everything apart from the selection, then simply press <code>&lt;SHIFT&gt;&lt;F5&gt;</code>, select “<em>White</em>” and press <code>&lt;CR&gt;</code></p>
  </li>
  <li>
    <p>Save the file as a format supporting alpha channels by pressing <code>&lt;CMD&gt;&lt;SHIFT&gt;S</code>. For PhotoScan imports, <code>TIFF</code> is recommended. Tick the box called “<em>Alpha Channels</em>” and press <code>&lt;CR&gt;</code> twice to save.</p>
  </li>
  <li>
    <p>(<strong>optional</strong>) In PhotoScan, after loading the photos into the workspace with <em>Workflow</em>&gt;<em>Add photos</em>/<em>Add folder</em>, click <em>Tools</em>&gt;<em>Import</em>&gt;<em>Import masks…</em>. Make sure that “<em>Method</em>” is set to “<em>From Alpha</em>” and click okay. The masked areas will then be darkened to indicate they are masked.</p>
  </li>
</ol>

<p><strong>Bonus Tip:</strong> To import masks from one photo into another, simpler drag the channel onto the new photo.</p>

<p>Note that this is based on the ancient CS3 that’s installed on the Mac I’m currently using, and may not apply to newer versions.</p>

<h2 id="python">Python</h2>

<h3 id="argparse">argparse</h3>

<p>Skeleton <code>argparse</code> template:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Import the library</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="c"># Description of the program</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Short description of the Python program.&quot;</span><span class="p">)</span>

<span class="c"># A compulsory positional argument</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;compulsory&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Description of argument, what it does and what the options are.&quot;</span><span class="p">)</span>

<span class="c"># A required normal argument</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-o&quot;</span><span class="p">,</span> <span class="s">&quot;--option&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Short description&quot;</span><span class="p">)</span>

<span class="c"># An optional true/false argument</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--verbose&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Short description&quot;</span><span class="p">)</span>

<span class="c"># Specifying the type</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--float&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Short description&quot;</span><span class="p">)</span>

<span class="c"># Specifying the default value</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="s">&quot;--name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;drew&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Short description&quot;</span><span class="p">)</span>

<span class="c"># Parse the arguments</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="c"># Accessing the values of the arguments</span>
<span class="n">myArgument</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">compulsory</span>
<span class="n">myName</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span></code></pre></div>

<h3 id="replace--with-home-directory">Replace <code>~</code> with home directory</h3>

<p>This is just a fun little script that replaces <code>~</code> in a string with the path to the user directory, e.g. <code>/home/drew</code>. Useful for taking input and output filenames from input, and want people to be able to use their familiar tilde.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c"># Replace &#39;~&#39; in fname with path to user dir</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;~&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;HOME&#39;</span><span class="p">],</span> <span class="n">fname</span><span class="p">)</span></code></pre></div>

<h3 id="increase-size-of-pyplot-legend">Increase size of pyplot legend</h3>

<p>Sometimes, the legend in matplotlib isn’t quite big enough. Increase it with:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>

<h3 id="fix-spacing-in-pyplot-multiplots">Fix spacing in pyplot multiplots</h3>

<p>Every time I do a subplot in pyplot, I get annoyed at the spacing, and every time I forget that all you need to do is put the following in your script and it will automagically sort the spacing out for you:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span></code></pre></div>

<p>Why is this not a standard part of matplotlib? I don’t know.</p>

<h3 id="change-x-or-y-ticks-on-pyplot-plot">Change x or y ticks on pyplot plot</h3>

<p>You can use either <code>np.arange</code> or specify the ticks yourself:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Automatically generate ticks for x axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>

<span class="c"># Manually specify ticks for y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">109</span><span class="p">])</span></code></pre></div>

<h3 id="set-custom-limits-on-pyplot-plot">Set custom limits on pyplot plot</h3>

<p>Here you can both retrieve and set the x and y limits with <code>plt.xlim</code> and <code>plt.ylim</code>:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span> <span class="c"># Returns the current x axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span> <span class="c"># Returns the current y axis limits</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span> <span class="c"># Sets the x axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">159</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c"># Sets the y axis limits</span></code></pre></div>

<h2 id="perl">Perl</h2>

<h3 id="pie">Pie</h3>

<p>Probably the most useful thing that <code>perl</code> can do is <code>perl </code>-pi -e`, often lovingly called Perl Pie. The syntax is:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">perl -pi -e <span class="s2">&quot;s/string to find/string to replace/g&quot;</span> filenames</code></pre></div>

<p>This replaces <code>string to find</code> with <code>string to replace</code> in filenames. This is fully regex compatible. For instance, if I wanted to replace <code>mispelt</code> with <code>misspelt</code> in all files ending in <code>.txt</code>, I would run:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">perl -pi -e <span class="s2">&quot;s/mispelt/misspelt/g&quot;</span> *.txt</code></pre></div>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/calculating-overlap">
            Calculating the overlap of aerial photos
            <small>31 Jul 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/custom-jekyll-plugins">
            Custom Jekyll plugins with GitHub Pages
            <small>29 Jul 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/meters-per-pixel">
            Calculating meters per pixel from aerial photographs
            <small>21 Jul 2014</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>



    <!-- Message inviting everyone to comment -->
    <div class="discuss">
        If you liked this post, have any questions or fancy having a good discussion, please leave a comment below, or 
        <a href = "mailto:drewATdrewsilcockDOTcoDOTuk" 
           onclick = "this.href=this.href
                      .replace(/AT/,'&#64;')
                      .replace(/DOT/,'&#46;')
                      .replace(/DOT/,'&#46;')"
        >send me an email.</a>
    </div>

    <!-- Add Disqus comments -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'drewsilcock'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
 


    </div>

  </body>

</html>

